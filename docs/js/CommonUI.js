var charExample = "<div class=\"card\"><div class=\"card-content\"><div class=\"row\"><div id=\"pieChartContainer\" data-highcharts-chart=\"1\" style=\"overflow: hidden;\"><div id=\"highcharts-2q2wh2o-32\" dir=\"ltr\" class=\"highcharts-container \" style=\"position: relative; overflow: hidden; width: 351px; height: 400px; text-align: left; line-height: normal; z-index: 0; -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\"><svg version=\"1.1\" class=\"highcharts-root\" style=\"font-family:&quot;Lucida Grande&quot;, &quot;Lucida Sans Unicode&quot;, Arial, Helvetica, sans-serif;font-size:12px;\" xmlns=\"http://www.w3.org/2000/svg\" width=\"351\" height=\"400\" viewBox=\"0 0 351 400\"><desc>Created with Highcharts 7.2.0</desc><defs><clipPath id=\"highcharts-2q2wh2o-38-\"><rect x=\"0\" y=\"0\" width=\"331\" height=\"273\" fill=\"none\"></rect></clipPath></defs><rect fill=\"#ffffff\" class=\"highcharts-background\" x=\"0\" y=\"0\" width=\"351\" height=\"400\" rx=\"0\" ry=\"0\"></rect><rect fill=\"none\" class=\"highcharts-plot-background\" x=\"10\" y=\"61\" width=\"331\" height=\"273\"></rect><rect fill=\"none\" class=\"highcharts-plot-border\" data-z-index=\"1\" x=\"10\" y=\"61\" width=\"331\" height=\"273\"></rect><g class=\"highcharts-series-group\" data-z-index=\"3\"><g data-z-index=\"0.1\" class=\"highcharts-series highcharts-series-0 highcharts-pie-series  highcharts-tracker  \" transform=\"translate(10,61) scale(1 1)\" style=\"cursor:pointer;\"><path fill=\"#90ed7d\" d=\"M 85.2511778825998 234.28740485752684 A 126.5 126.5 0 0 1 72.71811189348463 50.51295888687609 L 73.4515655544057 51.19269834231581 A 125.5 125.5 0 0 0 85.88555592305356 233.51438189422623 Z\" class=\"highcharts-halo highcharts-color-2\" data-z-index=\"-1\" fill-opacity=\"0.25\" visibility=\"hidden\"></path><path fill=\"rgb(124,181,236)\" d=\"M 165.47423533973256 10.000002623785477 A 126.5 126.5 0 0 1 232.02886941675686 244.09256263389267 L 165.5 136.5 A 0 0 0 0 0 165.5 136.5 Z\" transform=\"translate(0,0)\" stroke=\"#ffffff\" stroke-width=\"1\" opacity=\"1\" stroke-linejoin=\"round\" class=\"highcharts-point highcharts-color-0     \"></path><path fill=\"#434348\" d=\"M 231.92124360762313 244.15903769594445 A 126.5 126.5 0 0 1 85.34900539556715 234.36760477257107 L 165.5 136.5 A 0 0 0 0 0 165.5 136.5 Z\" transform=\"translate(0,0)\" stroke=\"#ffffff\" stroke-width=\"1\" opacity=\"1\" stroke-linejoin=\"round\" class=\"highcharts-point highcharts-color-1  \"></path><path fill=\"rgb(144,237,125)\" d=\"M 85.2511778825998 234.28740485752684 A 126.5 126.5 0 0 1 72.71811189348463 50.51295888687609 L 165.5 136.5 A 0 0 0 0 0 165.5 136.5 Z\" transform=\"translate(0,0)\" stroke=\"#ffffff\" stroke-width=\"1\" opacity=\"1\" stroke-linejoin=\"round\" class=\"highcharts-point highcharts-color-2   \"></path><path fill=\"rgb(247,163,92)\" d=\"M 72.80414531120675 50.4202200077502 A 126.5 126.5 0 0 1 128.43236282016102 15.552737633695003 L 165.5 136.5 A 0 0 0 0 0 165.5 136.5 Z\" transform=\"translate(0,0)\" stroke=\"#ffffff\" stroke-width=\"1\" opacity=\"1\" stroke-linejoin=\"round\" class=\"highcharts-point highcharts-color-3    \"></path><path fill=\"rgb(128,133,233)\" d=\"M 128.55332859618653 15.515730476319234 A 126.5 126.5 0 0 1 165.32429403783394 10.00012202608707 L 165.5 136.5 A 0 0 0 0 0 165.5 136.5 Z\" transform=\"translate(0,0)\" stroke=\"#ffffff\" stroke-width=\"1\" opacity=\"1\" stroke-linejoin=\"round\" class=\"highcharts-point highcharts-color-4    \"></path></g><g data-z-index=\"0.1\" class=\"highcharts-markers highcharts-series-0 highcharts-pie-series   \" transform=\"translate(10,61) scale(1 1)\"></g></g><g class=\"highcharts-exporting-group\" data-z-index=\"3\"><g class=\"highcharts-button highcharts-contextbutton\" stroke-linecap=\"round\" transform=\"translate(317,10)\"><title>Chart context menu</title><rect fill=\"#ffffff\" class=\"highcharts-button-box\" x=\"0.5\" y=\"0.5\" width=\"24\" height=\"22\" rx=\"2\" ry=\"2\" stroke=\"none\" stroke-width=\"1\"></rect><path fill=\"#666666\" d=\"M 6 6.5 L 20 6.5 M 6 11.5 L 20 11.5 M 6 16.5 L 20 16.5\" class=\"highcharts-button-symbol\" data-z-index=\"1\" stroke=\"#666666\" stroke-width=\"3\"></path><text x=\"0\" data-z-index=\"1\" style=\"font-weight:normal;color:#333333;cursor:pointer;fill:#333333;\" y=\"12\"></text></g></g><text x=\"176\" text-anchor=\"middle\" class=\"highcharts-title\" data-z-index=\"4\" style=\"color:#333333;font-size:18px;fill:#333333;\" y=\"24\"><tspan>Active Documents by Region</tspan></text><text x=\"156\" text-anchor=\"middle\" class=\"highcharts-subtitle\" data-z-index=\"4\" style=\"color:#666666;fill:#666666;\" y=\"46\"><tspan>2019</tspan></text><text x=\"10\" text-anchor=\"start\" class=\"highcharts-caption\" data-z-index=\"4\" style=\"color:#666666;fill:#666666;\" y=\"397\"></text><g class=\"highcharts-legend\" data-z-index=\"7\" transform=\"translate(41,346)\"><rect fill=\"none\" class=\"highcharts-legend-box\" rx=\"0\" ry=\"0\" x=\"0\" y=\"0\" width=\"269\" height=\"39\" visibility=\"visible\"></rect><g data-z-index=\"1\"><g><g class=\"highcharts-legend-item highcharts-pie-series highcharts-color-0\" data-z-index=\"1\" transform=\"translate(8,3)\"><text x=\"21\" style=\"color:#333333;cursor:pointer;font-size:12px;font-weight:bold;fill:#333333;\" text-anchor=\"start\" data-z-index=\"2\" y=\"15\"><tspan>Africa</tspan></text><rect x=\"2\" y=\"4\" width=\"12\" height=\"12\" fill=\"#7cb5ec\" rx=\"6\" ry=\"6\" class=\"highcharts-point\" data-z-index=\"3\"></rect></g><g class=\"highcharts-legend-item highcharts-pie-series highcharts-color-1\" data-z-index=\"1\" transform=\"translate(99.3125,3)\"><text x=\"21\" y=\"15\" style=\"color:#333333;cursor:pointer;font-size:12px;font-weight:bold;fill:#333333;\" text-anchor=\"start\" data-z-index=\"2\"><tspan>America</tspan></text><rect x=\"2\" y=\"4\" width=\"12\" height=\"12\" fill=\"#434348\" rx=\"6\" ry=\"6\" class=\"highcharts-point\" data-z-index=\"3\"></rect></g><g class=\"highcharts-legend-item highcharts-pie-series highcharts-color-2\" data-z-index=\"1\" transform=\"translate(190.625,3)\"><text x=\"21\" y=\"15\" style=\"color:#333333;cursor:pointer;font-size:12px;font-weight:bold;fill:#333333;\" text-anchor=\"start\" data-z-index=\"2\"><tspan>Asia</tspan></text><rect x=\"2\" y=\"4\" width=\"12\" height=\"12\" fill=\"#90ed7d\" rx=\"6\" ry=\"6\" class=\"highcharts-point\" data-z-index=\"3\"></rect></g><g class=\"highcharts-legend-item highcharts-pie-series highcharts-color-3\" data-z-index=\"1\" transform=\"translate(8,17)\"><text x=\"21\" y=\"15\" style=\"color:#333333;cursor:pointer;font-size:12px;font-weight:bold;fill:#333333;\" text-anchor=\"start\" data-z-index=\"2\"><tspan>Europe</tspan></text><rect x=\"2\" y=\"4\" width=\"12\" height=\"12\" fill=\"#f7a35c\" rx=\"6\" ry=\"6\" class=\"highcharts-point\" data-z-index=\"3\"></rect></g><g class=\"highcharts-legend-item highcharts-pie-series highcharts-color-4\" data-z-index=\"1\" transform=\"translate(99.3125,17)\"><text x=\"21\" y=\"15\" style=\"color:#333333;cursor:pointer;font-size:12px;font-weight:bold;fill:#333333;\" text-anchor=\"start\" data-z-index=\"2\"><tspan>Oceania</tspan></text><rect x=\"2\" y=\"4\" width=\"12\" height=\"12\" fill=\"#8085e9\" rx=\"6\" ry=\"6\" class=\"highcharts-point\" data-z-index=\"3\"></rect></g></g></g></g><g class=\"highcharts-label highcharts-tooltip     highcharts-color-2\" style=\"pointer-events:none;white-space:nowrap;\" data-z-index=\"8\" transform=\"translate(35,-9999)\" opacity=\"0\" visibility=\"visible\"><path fill=\"none\" class=\"highcharts-label-box highcharts-tooltip-box highcharts-shadow\" d=\"M 3.5 0.5 L 49.5 0.5 C 52.5 0.5 52.5 0.5 52.5 3.5 L 52.5 40.5 C 52.5 43.5 52.5 43.5 49.5 43.5 L 3.5 43.5 C 0.5 43.5 0.5 43.5 0.5 40.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5\" stroke=\"#000000\" stroke-opacity=\"0.049999999999999996\" stroke-width=\"5\" transform=\"translate(1, 1)\"></path><path fill=\"none\" class=\"highcharts-label-box highcharts-tooltip-box highcharts-shadow\" d=\"M 3.5 0.5 L 49.5 0.5 C 52.5 0.5 52.5 0.5 52.5 3.5 L 52.5 40.5 C 52.5 43.5 52.5 43.5 49.5 43.5 L 3.5 43.5 C 0.5 43.5 0.5 43.5 0.5 40.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5\" stroke=\"#000000\" stroke-opacity=\"0.09999999999999999\" stroke-width=\"3\" transform=\"translate(1, 1)\"></path><path fill=\"none\" class=\"highcharts-label-box highcharts-tooltip-box highcharts-shadow\" d=\"M 3.5 0.5 L 49.5 0.5 C 52.5 0.5 52.5 0.5 52.5 3.5 L 52.5 40.5 C 52.5 43.5 52.5 43.5 49.5 43.5 L 3.5 43.5 C 0.5 43.5 0.5 43.5 0.5 40.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5\" stroke=\"#000000\" stroke-opacity=\"0.15\" stroke-width=\"1\" transform=\"translate(1, 1)\"></path><path fill=\"rgba(247,247,247,0.85)\" class=\"highcharts-label-box highcharts-tooltip-box\" d=\"M 3.5 0.5 L 49.5 0.5 C 52.5 0.5 52.5 0.5 52.5 3.5 L 52.5 40.5 C 52.5 43.5 52.5 43.5 49.5 43.5 L 3.5 43.5 C 0.5 43.5 0.5 43.5 0.5 40.5 L 0.5 3.5 C 0.5 0.5 0.5 0.5 3.5 0.5\" stroke=\"#90ed7d\" stroke-width=\"1\"></path><text x=\"8\" data-z-index=\"1\" style=\"font-size:12px;color:#333333;cursor:default;fill:#333333;\" y=\"20\"><tspan style=\"font-size: 10px\">Asia</tspan><tspan style=\"font-weight:bold\" x=\"8\" dy=\"15\">26.0%</tspan></text></g></svg></div></div></div></div></div>";

//Get Country record popup HTML
function getCountryPopupHTML(name, code, recordcount) {
    var url = "javascript:void(0);";
    if (code != "") {
        url = "/search?country=" + code;
    }
    var imgExample = "<img src=\"placeholders/2014-09-15_08432.png\" class=\"img-responsive\" >";

    var html = "<a class=\"leaflet-link\" href=\"" + url + "\"><div class=\"leaflet-popup-wrapper\"><div class=\"leaflet-popup-title\">" + name +
               "</div><div class=\"leaflet-popup-budget-wrapper\">"+charExample+"No. of documents: <span>" + recordcount + "</span></div></div></a>";
    return html;
}

//Get Fill Opacity
function getFillOpacity(recordCount, maxRecord, minRecord) {
    var minOpacity = .2;
    var maxOpacity = .9;
    var opacity = maxOpacity - ((maxOpacity - minOpacity) * (maxRecord - recordCount)) / (maxRecord - minRecord);
    return opacity;
}

//World Map Start 
function populateWorldMap(recordURL) {

    var borderColor = "#FFFFFF";
    var fillColor = "#1FCB4A";
    var weight = 2;

    var hoverStyle = {
        "color": borderColor,
        "fillColor": "#6CA870",
        "weight": weight,
        "fillOpacity": .5
    };
    var legendHTML =
    "<div id=\"legend\"><div class=\"legend-main\"></div><span class=\"txt pull-left\">Min Doc</span><span class=\"txt pull-right\">Max Doc</span></div>"

    L.mapbox.accessToken = "pk.eyJ1IjoiZGViYWppdG11a2hlcmplZSIsImEiOiJjaWV2YzVlMWowd2N3czltMm43aGt5Z2t5In0.AeB5WR5Tl0bGXHr-A7iyJA";
    map = L.mapbox.map("map", "mapbox.streets", {
        attributionControl: false,
        scrollWheelZoom: true,
        zoom: 3,
        minZoom: 2,
        maxZoom: 16,
        continuousWorld: false,
        legendControl: {            
            position: 'bottomleft'
        }
    }).setView([10.505, 25.09], 3);
    map.legendControl.addLegend(legendHTML);
    L.tileLayer('https://{s}.tiles.mapbox.com/v3/zimmerman2014.hmj09g6h/{z}/{x}/{y}.png', {
        maxZoom: 16
    }).addTo(map);

    var isMouseOver = false;
    $.ajax({
        url: recordURL,
        success: function (result) {
            var countries = JSON.parse(result);

            for (count = 0; count < countries.length; count++) {
                //console.log(countries[count].CountryName);
                var fillOpacity = getFillOpacity(countries[count].RecordCount, countries[count].MaxRecord, countries[count].MinRecord);//countries[count].FillOpacity;
                var countryJson = JSON.parse(countries[count].GeoJSON);
                var html = getCountryPopupHTML(countries[count].CountryName, countries[count].CountryCode, countries[count].RecordCount);
                var itemLayer = L.geoJson(countryJson);
                var item = itemLayer.bindPopup(html).addTo(map);
                item.setStyle({
                    "color": borderColor,
                    "fillColor": fillColor,
                    "weight": weight,
                    "fillOpacity": fillOpacity
                });

                item.RecordCount = countries[count].RecordCount;
                item.MaxRecord = countries[count].MaxRecord;
                item.MinRecord = countries[count].MinRecord;
                item.CountryCode = countries[count].CountryCode;

                // Create a self-invoking function that passes in the layer
                // and the properties associated with this particular record.

                (function (item) {
                    // Create a mouseover event
                    item.on("mouseover", function (e) {                      
                        if (isMouseOver == false) {
                            item.setStyle(hoverStyle);
                            item.openPopup();
                        }
                        isMouseOver = true;
                        //console.log(item.CountryCode);
                    });
                    // Create a mouseout event that undoes the mouseover changes
                    item.on("mouseout", function (e) {
                                              
                        if (isMouseOver == true) {
                            var fillOpacity = getFillOpacity(item.RecordCount, item.MaxRecord, item.MinRecord);
                            item.setStyle({
                                "color": borderColor,
                                "fillColor": fillColor,
                                "weight": weight,
                                "fillOpacity": fillOpacity
                            });
                        }

                        isMouseOver = false;
                       // item.closePopup();
                    });
                    // Close the "anonymous" wrapper function, and call it while passing
                    // in the variables necessary to make the events work the way we want.
                })(item);

            }

        }
    });
}

//Populate Search page map
function PopulateFilteredMap(jsonData) {
    var borderColor = "#FFFFFF";
    var fillColor = "#1FCB4A";
    var weight = 2;

    var hoverStyle = {
        "color": borderColor,
        "fillColor": "#6CA870",
        "weight": weight,
        "fillOpacity": .5
    };
    // esta es la legend de la esquina inferior izquierda
    var legendHTML =
    "<div id=\"legend\"><div class=\"legend-main\"></div><span class=\"txt pull-left\">Min Doc</span><span class=\"txt pull-right\">Max Doc</span></div>"

    L.mapbox.accessToken = "pk.eyJ1IjoiZGViYWppdG11a2hlcmplZSIsImEiOiJjaWV2YzVlMWowd2N3czltMm43aGt5Z2t5In0.AeB5WR5Tl0bGXHr-A7iyJA";
    map = L.mapbox.map("map", "mapbox.streets", {
        attributionControl: false,
        scrollWheelZoom: true,
        zoom: 3,
        minZoom: 2,
        maxZoom: 16,
        continuousWorld: false,
        legendControl: {
            position: 'bottomleft'
        }
    }).setView([10.505, 25.09], 3);
    map.legendControl.addLegend(legendHTML);
    L.tileLayer('https://{s}.tiles.mapbox.com/v3/zimmerman2014.hmj09g6h/{z}/{x}/{y}.png', {
        maxZoom: 16
    }).addTo(map);

    var isMouseOver = false;
    try {


        var countries = jsonData;

        for (count = 0; count < countries.length; count++) {
            //console.log(countries[count].CountryName);
            var fillOpacity = getFillOpacity(countries[count].RecordCount, countries[count].MaxRecord, countries[count].MinRecord);//countries[count].FillOpacity;
            var countryJson = JSON.parse(countries[count].GeoJSON);
            var html = getCountryPopupHTML(countries[count].CountryName, "", countries[count].RecordCount);
            var itemLayer = L.geoJson(countryJson);
            var item = itemLayer.bindPopup(html).addTo(map);
            item.setStyle({
                "color": borderColor,
                "fillColor": fillColor,
                "weight": weight,
                "fillOpacity": fillOpacity
            });

            item.RecordCount = countries[count].RecordCount;
            item.MaxRecord = countries[count].MaxRecord;
            item.MinRecord = countries[count].MinRecord;
            item.CountryCode = countries[count].CountryCode;

            // Create a self-invoking function that passes in the layer
            // and the properties associated with this particular record.
            (function (item) {
                // Create a mouseover event
                item.on("mouseover", function (e) {
                    if (isMouseOver == false) {
                        item.setStyle(hoverStyle);
                        item.openPopup();
                    }
                    isMouseOver = true;
                    //console.log(item.CountryCode);
                });
                // Create a mouseout event that undoes the mouseover changes
                item.on("mouseout", function (e) {

                    if (isMouseOver == true) {
                        var fillOpacity = getFillOpacity(item.RecordCount, item.MaxRecord, item.MinRecord);
                        item.setStyle({
                            "color": borderColor,
                            "fillColor": fillColor,
                            "weight": weight,
                            "fillOpacity": fillOpacity
                        });
                    }
                    isMouseOver = false;
                });
                // Close the "anonymous" wrapper function, and call it while passing
                // in the variables necessary to make the events work the way we want.
            })(item);

        }
    } catch (e) {
        //alert(e);
    }
}

//WorldMap End

var downloadingPDF = false;
function downloadPDFWorldMap(obj) {
    if (downloadingPDF) {
        return;
    }
    downloadingPDF = true;
    obj.css("cursor", "wait");
    try {

        leafletImage(map, function (err, canvas) {
            var dimensions = map.getSize();
            var doc = new jsPDF();
            doc.setFontSize(15);

            try {
                var imgData = canvas.toDataURL();
                var maxwidth = 210;
                var maxHeight = (dimensions.y * 210) / dimensions.x;
                
                //  window.open(imgData);
                doc.addImage(imgData, "PNG", 0, 0, maxwidth, maxHeight);

                try {
                    doc.save("WorldMap.pdf");
                    //doc.output("dataurlnewwindow");
                } catch (e) {
                    doc.output("dataurlnewwindow");
                }
            } catch (e) {
                alert(e);
            }
            obj.css("cursor", "");
            downloadingPDF = false;

        });
    } catch (e) {
        
    }
}

function populateCountryMap(latitude, longitude, countryCodes) {
    L.mapbox.accessToken = "pk.eyJ1IjoiZGViYWppdG11a2hlcmplZSIsImEiOiJjaWV2YzVlMWowd2N3czltMm43aGt5Z2t5In0.AeB5WR5Tl0bGXHr-A7iyJA";
    map = L.mapbox.map("map", "mapbox.streets", {
        attributionControl: false,
        scrollWheelZoom: false,
        zoom: 3,
        minZoom: 2,
        maxZoom: 16,
        continuousWorld: false
    }).setView([latitude, longitude], 3);

    L.tileLayer('https://{s}.tiles.mapbox.com/v3/zimmerman2014.hmj09g6h/{z}/{x}/{y}.png', {
        maxZoom: 16
    }).addTo(map);

    var countryJSONURL = "/document/GetCountryJSON?countryCodes=" + countryCodes;
    var borderColor = "#FFFFFF";
    var fillColor = "#1FCB4A";
    var weight = 2;

    $.ajax({
        url: countryJSONURL,
        success: function (result) {
            var countries = JSON.parse(result);

            for (count = 0; count < countries.length; count++) {
                //console.log(countries[count].CountryName);
                var fillOpacity = 0.6 //getFillOpacity(countries[count].RecordCount, countries[count].MaxRecord, countries[count].MinRecord);//countries[count].FillOpacity;
                var countryJson = JSON.parse(countries[count].GeoJSON);
                var html = "";//getCountryPopupHTML(countries[count].CountryName, countries[count].RecordCount);
                var itemLayer = L.geoJson(countryJson);
                var item = itemLayer.addTo(map);//bindPopup(html).addTo(map);
                item.setStyle({
                    "color": borderColor,
                    "fillColor": fillColor,
                    "weight": weight,
                    "fillOpacity": fillOpacity
                });

                item.RecordCount = countries[count].RecordCount;
                item.MaxRecord = countries[count].MaxRecord;
                item.MinRecord = countries[count].MinRecord;
                item.CountryCode = countries[count].CountryCode;

                /*
                // Create a self-invoking function that passes in the layer
                // and the properties associated with this particular record.
                (function (item) {
                    // Create a mouseover event
                    item.on("mouseover", function (e) {
                        item.setStyle(hoverStyle);
                        //console.log(item.CountryCode);
                    });
                    // Create a mouseout event that undoes the mouseover changes
                    item.on("mouseout", function (e) {
                        var fillOpacity = getFillOpacity(item.RecordCount, item.MaxRecord, item.MinRecord);
                        item.setStyle({
                            "color": borderColor,
                            "fillColor": fillColor,
                            "weight": weight,
                            "fillOpacity": fillOpacity
                        });
                    });
                    // Close the "anonymous" wrapper function, and call it while passing
                    // in the variables necessary to make the events work the way we want.
                })(item); */

            }

        }
    });
}

var regionChangeTimeout;
function PopulateCountryByRegion() {
    $("#Region").change(function () {
        clearTimeout(regionChangeTimeout);
        setTimeout(function () {
            var regionIds = $("#Region").val();
            
            $.ajax({
                url: "/home/GetCountriesByRegion?regionIDs=" + regionIds,
                success: function (result) {
                    
                    //remove all options
                    $("#Country").find("option").remove();
                    for (count = 0; count < result.length; count++) {
                        $("#Country").append($("<option></option>").attr("value", result[count].Key).text(result[count].Value));
                    }

                    $("#Country").selectpicker("refresh");
                }
            });

        }, 900);
    });
}






//function populateFilterWorldMap(recordURL, regionValues, countryValues, sectorValues, documentTypesValues, year, period, last_Update, counterpart, DocCheckboxData, thematicCheckboxData, designProcessCheckboxData) {
//    debugger;
//    var borderColor = "#FFFFFF";
//    var fillColor = "#1FCB4A";
//    var weight = 2;

//    var hoverStyle = {
//        "color": borderColor,
//        "fillColor": "#6CA870",
//        "weight": weight,
//        "fillOpacity": .5
//    };
    
//    //L.mapbox.accessToken = "pk.eyJ1IjoiZGViYWppdG11a2hlcmplZSIsImEiOiJjaWV2YzVlMWowd2N3czltMm43aGt5Z2t5In0.AeB5WR5Tl0bGXHr-A7iyJA";
//    //map = L.mapbox.map("map", "mapbox.streets", {
//    //    attributionControl: false,
//    //    scrollWheelZoom: false,
//    //    zoom: 3,
//    //    minZoom: 2,
//    //    maxZoom: 6,
//    //    continuousWorld: false
//    //}).setView([10.505, 25.09], 3);

//    //L.tileLayer('https://{s}.tiles.mapbox.com/v3/zimmerman2014.hmj09g6h/{z}/{x}/{y}.png', {
//    //    maxZoom: 6
//    //}).addTo(map);

    
//    $.ajax({
//        url: recordURL,
//        data: {
//            'region': regionValues,
//            'country': countryValues,
//            'Sector': sectorValues,
//            'document': documentTypesValues,
//            'year': year,
//            'period': period,
//            'last_Update': last_Update,
//            'counterpart': counterpart,
//            'DocCheckboxData': DocCheckboxData,
//            'thematicCheckboxData': thematicCheckboxData,
//            'designProcessCheckboxData': designProcessCheckboxData
//        },
//        success: function (result) {
//            var countries = JSON.parse(result);

//            for (count = 0; count < countries.length; count++) {
//                //console.log(countries[count].CountryName);
//                var fillOpacity = getFillOpacity(countries[count].RecordCount, countries[count].MaxRecord, countries[count].MinRecord);//countries[count].FillOpacity;
//                var countryJson = JSON.parse(countries[count].GeoJSON);
//                var html = getCountryPopupHTML(countries[count].CountryName, countries[count].RecordCount);
//                var itemLayer = L.geoJson(countryJson);
//                var item = itemLayer.bindPopup(html).addTo(map);
//                item.setStyle({
//                    "color": borderColor,
//                    "fillColor": fillColor,
//                    "weight": weight,
//                    "fillOpacity": fillOpacity
//                });

//                item.RecordCount = countries[count].RecordCount;
//                item.MaxRecord = countries[count].MaxRecord;
//                item.MinRecord = countries[count].MinRecord;
//                item.CountryCode = countries[count].CountryCode;

//                // Create a self-invoking function that passes in the layer
//                // and the properties associated with this particular record.
//                (function (item) {
//                    // Create a mouseover event
//                    item.on("mouseover", function (e) {
//                        item.setStyle(hoverStyle);
//                        //console.log(item.CountryCode);
//                    });
//                    // Create a mouseout event that undoes the mouseover changes
//                    item.on("mouseout", function (e) {
//                        var fillOpacity = getFillOpacity(item.RecordCount, item.MaxRecord, item.MinRecord);
//                        item.setStyle({
//                            "color": borderColor,
//                            "fillColor": fillColor,
//                            "weight": weight,
//                            "fillOpacity": fillOpacity
//                        });
//                    });
//                    // Close the "anonymous" wrapper function, and call it while passing
//                    // in the variables necessary to make the events work the way we want.
//                })(item);

//            }

//        }
//    });
//}